p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
n <- 100
x1 <- rnorm(n, 0, 3)
x2 <- rnorm(n, 7, 1)
X <- density(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter1.png", width = 6, height = 4)
p1 = 0
p2 = 8
pmean = (p1 + p2)/2
pmedian = median(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter2.png", width = 6, height = 4)
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter3.png", width = 6, height = 4)
p1 = 4
p2 = 8
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter4.png", width = 6, height = 4)
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter5.png", width = 6, height = 4)
X <- density(c(x1, x1, x2))
pmedian = median(c(x1, x1, x2))
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter4.png", width = 6, height = 4)
setwd("~/Dropbox/teaching/0_textbook/intro_polisci")
library(tidyverse)
theme_set(theme_light(base_family = "Noto Sans CJk JP Light"))
df_voters <- read_csv("data/2023UTASV20230416.csv", na = "99",
locale = locale(encoding = "Shift-JIS"))
gen <- c("18,19", "20~24", "25~29", "30~34", "35~39","40~44", "45~49",
"50~54", "55~59", "60~64", "65~69", "70~74", "75~79","80~84", "85以上")
party <- c("自民", "立憲", "維新", "公明", "共産", "国民", "れいわ", "社民",
"NHK", "参政", "支持なし", "無回答")
ggplot(df_voters) +
geom_bar(aes(x = factor(Q48), fill = factor(Q41)),
position = "fill") +
scale_x_discrete(labels = gen) +
scale_fill_discrete(labels = party) +
labs(x = "年代", y = "支持政党", fill = "") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
ggsave("figures/party_support_age.png", width = 6, height = 4)
n <- 100
x1 <- rnorm(n, 0, 3)
x2 <- rnorm(n, 7, 1)
X <- density(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter1.png", width = 6, height = 4)
p1 = 0
p2 = 8
pmean = (p1 + p2)/2
pmedian = median(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter2.png", width = 6, height = 4)
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter3.png", width = 6, height = 4)
p1 = 4
p2 = 8
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter4.png", width = 6, height = 4)
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter5.png", width = 6, height = 4)
X <- density(c(x1, x1, x2))
pmedian = median(c(x1, x1, x2))
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter6.png", width = 6, height = 4)
setwd("~/Dropbox/teaching/0_textbook/intro_polisci")
library(tidyverse)
theme_set(theme_light(base_family = "Noto Sans CJk JP Light"))
df_voters <- read_csv("data/2023UTASV20230416.csv", na = "99",
locale = locale(encoding = "Shift-JIS"))
gen <- c("18,19", "20~24", "25~29", "30~34", "35~39","40~44", "45~49",
"50~54", "55~59", "60~64", "65~69", "70~74", "75~79","80~84", "85以上")
party <- c("自民", "立憲", "維新", "公明", "共産", "国民", "れいわ", "社民",
"NHK", "参政", "支持なし", "無回答")
ggplot(df_voters) +
geom_bar(aes(x = factor(Q48), fill = factor(Q41)),
position = "fill") +
scale_x_discrete(labels = gen) +
scale_fill_discrete(labels = party) +
labs(x = "年代", y = "支持政党", fill = "") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
ggsave("figures/party_support_age.png", width = 6, height = 4)
n <- 100
x1 <- rnorm(n, 0, 3)
x2 <- rnorm(n, 7, 1)
X <- density(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter1.png", width = 6, height = 4)
p1 = 0
p2 = 8
pmean = (p1 + p2)/2
pmedian = median(c(x1, x2))
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter2.png", width = 6, height = 4)
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter3.png", width = 6, height = 4)
p1 = 4
p2 = 8
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter4.png", width = 6, height = 4)
p1 = 4
p2 = 6
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter5.png", width = 6, height = 4)
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter6.png", width = 6, height = 4)
X <- density(c(x1, x1, x2))
pmedian = median(c(x1, x1, x2))
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter7.png", width = 6, height = 4)
X <- density(c(x1, x1, x2))
pmedian = median(c(x1, x1, x2))
p1 = pmedian
p2 = pmedian
pmean = (p1 + p2)/2
tibble(x = X$x, y = X$y) %>%
mutate(party = if_else(x < pmean, "政党1", "政党2")) %>%
ggplot() +
geom_line(aes(x = x, y = y)) +
geom_ribbon(aes(x = x, ymin = 0, ymax = y, fill = party),
alpha = 0.5) +
geom_vline(aes(xintercept = p, color = party),
data = tibble(p = c(p1, p2),
party = c("政党1", "政党2"))) +
labs(x = "政策の位置", y = "有権者の割合", fill = "", color = "") +
theme(legend.position = "bottom")
ggsave("figures/median_voter7.png", width = 6, height = 4)
setwd("~/Dropbox/teaching/0_textbook/intro_polisci")
library(tidyverse)
theme_set(theme_bw(base_family = "Noto Sans CJk JP"))
library(ggforce)
library(countrycode)
df_ucdp <- read_csv("data/ucdp-prio-acd-221.csv")
df_ucdp %>%
count(year) %>%
ggplot() +
geom_line(aes(x = year, y = n), size = 0.25) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
labs(x = "年", y = "武力紛争発生数")
df_ucdp %>%
count(year) %>%
ggplot() +
geom_line(aes(x = year, y = n)) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
labs(x = "年", y = "武力紛争発生数")
ggsave("figures/conflict_ucdp.png", width = 6, height = 4)
df_ucdp <- read_csv("data/UcdpPrioConflict_v24_1.csv")
df_ucdp %>%
count(year) %>%
ggplot() +
geom_line(aes(x = year, y = n)) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
labs(x = "年", y = "武力紛争発生数")
ggsave("figures/conflict_ucdp.png", width = 6, height = 4)
left_join(expand(df_ucdp, year, type_of_conflict),
df_ucdp %>%
count(year, type_of_conflict)) %>%
replace_na(list(n = 0)) %>%
group_by(year) %>%
mutate(total = sum(n),
ratio = n/total) %>%
pivot_longer(c(n, ratio)) %>%
mutate(name = recode(name, n = "件数", ratio = "比率")) %>%
ggplot() +
geom_area(aes(x = year, y = value,
color = as.factor(type_of_conflict),
fill = as.factor(type_of_conflict)),
alpha = 0.5) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
scale_color_brewer(palette = "Set2", labels = type) +
scale_fill_brewer(palette = "Set2", labels = type) +
facet_grid(name ~ ., scales = "free_y") +
labs(x = "年", y = "武力紛争", color = "", fill = "") +
theme(legend.position = "bottom")
type <- c("独立戦争", "国家間戦争", "内戦", "国際介入のある内戦")
left_join(expand(df_ucdp, year, type_of_conflict),
df_ucdp %>%
count(year, type_of_conflict)) %>%
replace_na(list(n = 0)) %>%
group_by(year) %>%
mutate(total = sum(n),
ratio = n/total) %>%
pivot_longer(c(n, ratio)) %>%
mutate(name = recode(name, n = "件数", ratio = "比率")) %>%
ggplot() +
geom_area(aes(x = year, y = value,
color = as.factor(type_of_conflict),
fill = as.factor(type_of_conflict)),
alpha = 0.5) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
scale_color_brewer(palette = "Set2", labels = type) +
scale_fill_brewer(palette = "Set2", labels = type) +
facet_grid(name ~ ., scales = "free_y") +
labs(x = "年", y = "武力紛争", color = "", fill = "") +
theme(legend.position = "bottom")
ggsave("figures/conflict_type_ucdp.png", width = 6, height = 4)
df_mid_temp <- read_csv("data/mid/MIDA 5.0.csv", na = "-9")
df_mid <- NULL
for (i in 1:nrow(df_mid_temp)) {
temp <- df_mid_temp[i,]
year <- temp$styear:temp$endyear
df_mid <- bind_rows(df_mid, tibble(dispnum = temp$dispnum, year = year))
}
df_mid <- left_join(df_mid, df_mid_temp) %>%
mutate(intensity_level = case_when(fatality == 0 ~ "0",
fatality == 1 ~ "1",
between(fatality, 2, 5) ~ "2",
fatality == 6 ~ "3",
TRUE ~ "4"))
df_mid %>%
count(year) %>%
ggplot() +
geom_line(aes(x = year, y = n), size = 0.25) +
annotate("rect", xmin = 1914, xmax = 1918, ymin = -Inf, ymax = Inf, alpha = 0.25) +
annotate("rect", xmin = 1939, xmax = 1945, ymin = -Inf, ymax = Inf, alpha = 0.25) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
labs(x = "年", y = "武力紛争発生数")
ggsave("figures/conflict_mid.png", width = 6, height = 4)
type <- c("武力による威嚇", "武力の動員", "武力行使", "戦争")
left_join(expand(df_mid, year, hostlev),
df_mid %>%
count(year, hostlev)) %>%
replace_na(list(n = 0)) %>%
group_by(year) %>%
mutate(total = sum(n),
ratio = n/total) %>%
pivot_longer(c(n, ratio)) %>%
mutate(name = recode(name, n = "件数", ratio = "比率")) %>%
ggplot() +
geom_area(aes(x = year, y = value,
color = as.factor(hostlev),
fill = as.factor(hostlev)),
alpha = 0.5, size = 0.25) +
annotate("rect", xmin = 1914, xmax = 1918, ymin = -Inf, ymax = Inf, alpha = 0.25) +
annotate("rect", xmin = 1939, xmax = 1945, ymin = -Inf, ymax = Inf, alpha = 0.25) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
scale_color_brewer(palette = "Set2", labels = type) +
scale_fill_brewer(palette = "Set2", labels = type) +
facet_grid(name ~ ., scales = "free_y") +
labs(x = "年", y = "武力紛争発生数", color = "", fill = "") +
theme(legend.position = "bottom")
ggsave("figures/conflict_type_mid.png", width = 6, height = 4)
min(df_mid$styear)
max(df_mid$styear)
df_system <- read_csv("data/system2016.csv")
df_midb_temp <- read_csv("data/mid/MIDB 5.0.csv", na = "-9")
df_midb <- NULL
for (i in 1:nrow(df_midb_temp)) {
temp <- df_midb_temp[i,]
year <- temp$styear:temp$endyear
df_midb <- bind_rows(df_midb, tibble(dispnum = temp$dispnum,
stateabb = temp$stabb,
year = year))
}
left_join(df_system,
df_midb %>%
distinct(stateabb, year) %>%
mutate(mid = 1)) %>%
filter(year < 2015) %>%
group_by(year) %>%
summarise(n_country = n(),
n_dispute = sum(mid, na.rm = TRUE)) %>%
mutate(ratio = n_dispute/n_country) %>%
ggplot() +
geom_line(aes(x = year, y = ratio), size = 0.2) +
annotate("rect", xmin = 1914, xmax = 1918, ymin = -Inf, ymax = Inf, alpha = 0.25) +
annotate("rect", xmin = 1939, xmax = 1945, ymin = -Inf, ymax = Inf, alpha = 0.25) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
geom_hline(aes(yintercept = mean(ratio, na.rm = TRUE)),
linetype = "dashed", alpha = 0.5) +
labs(x = "年", y = "MIDの当事国の比率")
left_join(df_system,
df_midb %>%
distinct(stateabb, year) %>%
mutate(mid = 1)) %>%
filter(year < 2015) %>%
group_by(year) %>%
summarise(n_country = n(),
n_dispute = sum(mid, na.rm = TRUE)) %>%
mutate(ratio = n_dispute/n_country) %>%
ggplot() +
geom_line(aes(x = year, y = ratio)) +
annotate("rect", xmin = 1914, xmax = 1918, ymin = -Inf, ymax = Inf,
alpha = 0.25) +
annotate("rect", xmin = 1939, xmax = 1945, ymin = -Inf, ymax = Inf,
alpha = 0.25) +
geom_vline(aes(xintercept = 1991), alpha = 0.25) +
geom_hline(aes(yintercept = mean(ratio, na.rm = TRUE)),
linetype = "dashed", alpha = 0.5) +
labs(x = "年", y = "MIDの当事国の比率")
ggsave("figures/conflict_state_mid.png", width = 6, height = 4)
df_mid_state <- read_csv("data/mid/MIDB 5.0.csv", na = "-9")
df_midb_temp %>%
filter(revstate == 1)
df_midb_temp %>%
filter(revstate == 1) %>%
ggplot() +
geom_histogram(aes(x = revtype1))
df_midb_temp %>%
filter(revstate == 1) %>%
count(styear, revtype1) %>%
ggplot() +
geom_line(aes(x = styear, y = n, color = as.factor(revtype1)))
df_midb_temp %>%
filter(revstate == 1) %>%
count(styear, revtype1) %>%
group_by(styear) %>%
mutate(p = n/sum(n)) %>%
ggplot() +
geom_line(aes(x = styear, y = p, color = as.factor(revtype1)))
?quanteda::corpus
